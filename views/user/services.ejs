<%- include('include/head.ejs', { user }) %>
     <%- include('include/navbar.ejs', { user }) %>

          <!-- Category Tabs - Horizontal Scrollable -->
          <div class="w-full overflow-x-auto scrollbar-hide sticky top-16 bg-white/95 backdrop-blur-sm z-40 border-b border-gray-200">
               <div class="container mx-auto px-4">
                    <div class="flex space-x-6 py-4 no-scrollbar">
                         <!-- All Services -->
                         <a href="/services/tous" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'tous' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                                   </svg>
                                   <span>Tous les services</span>
                              </div>
                         </a>

                         <!-- Dressage -->
                         <a href="/services/dressage" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'dressage' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                   </svg>
                                   <span>Dressage</span>
                              </div>
                         </a>

                         <!-- Toilettage -->
                         <a href="/services/toilettage" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'toilettage' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z" />
                                   </svg>
                                   <span>Toilettage</span>
                              </div>
                         </a>

                         <!-- Promenade -->
                         <a href="/services/promenade" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'promenade' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                   </svg>
                                   <span>Promenade</span>
                              </div>
                         </a>

                         <!-- Vétérinaire -->
                         <a href="/services/veterinaire" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'veterinaire' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                                   </svg>
                                   <span>Vétérinaire</span>
                              </div>
                         </a>

                         <!-- Pension -->
                         <a href="/services/pension" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'pension' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                   </svg>
                                   <span>Pension</span>
                              </div>
                         </a>

                         <!-- Transport -->
                         <a href="/services/transport" class="flex-shrink-0 text-sm font-medium px-1 py-2 border-b-2 transition-colors duration-200 whitespace-nowrap
                    <%= serviceOption === 'transport' ? 'border-gray-900 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700' %>">
                              <div class="flex items-center space-x-2">
                                   <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                                   </svg>
                                   <span>Transport</span>
                              </div>
                         </a>
                    </div>
               </div>
          </div>

          <!-- Add these styles to your CSS -->
          <style>
               /* Hide scrollbar but keep functionality */
               .scrollbar-hide {
                    scrollbar-width: none;
                    /* Firefox */
                    -ms-overflow-style: none;
                    /* IE and Edge */
               }

               .scrollbar-hide::-webkit-scrollbar {
                    display: none;
                    /* Chrome, Safari, Opera */
               }

               /* Smooth scroll behavior */
               .container {
                    scroll-behavior: smooth;
               }

               /* Better touch scrolling on mobile */
               .no-scrollbar {
                    -webkit-overflow-scrolling: touch;
                    scroll-snap-type: x mandatory;
                    scroll-padding: 1rem;
               }

               /* Optional: Add active tab indicator animation */
               .border-b-2 {
                    transition: border-color 0.2s ease-in-out;
               }

               /* Optional: Add hover effect for desktop */
               @media (min-width: 1024px) {
                    .hover\:text-gray-700:hover {
                         transform: translateY(-1px);
                    }
               }

               /* Optional: Add active tab scale effect */
               .border-gray-900 {
                    transform: translateY(-1px);
               }
          </style>

          <!-- Services List Container -->
          <div class="container mx-auto px-4 py-6">
               <% if (services && services.length> 0) { %>
                    <div class="space-y-4">
                         <% services.forEach(service=> { %>
                              <!-- Service Card -->
                              <div class="group relative bg-white rounded-xl shadow-sm hover:shadow-md transition-all duration-300 overflow-hidden" onclick="window.location.href='/service/<%= service._id %>'" role="link" tabindex="0">

                                   <div class="flex flex-row h-full">
                                        <!-- Image Section -->
                                        <div class="relative w-32 sm:w-48">
                                             <% if (service.images && service.images.length> 0) { %>
                                                  <div class="absolute inset-0">
                                                       <img src="<%= service.images[0] %>" alt="<%= service.serviceOptions?.[0] || 'Service' %>" class="h-full w-full object-cover" loading="lazy">
                                                  </div>
                                                  <% } else { %>
                                                       <div class="absolute inset-0 bg-gray-100 flex items-center justify-center">
                                                            <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                            </svg>
                                                       </div>
                                                       <% } %>

                                                            <!-- Service Type Badge -->
                                                            <div class="absolute top-2 left-2">
                                                                 <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium 
                                                bg-white/90 backdrop-blur-sm text-gray-900 shadow-sm">
                                                                      <% const serviceIcons={ 'dog-training' : '🐕' , 'grooming' : '✂️' , 'walking' : '🦮' , 'veterinary' : '⚕️' , 'boarding' : '🏠' , 'transport' : '🚗' }; const serviceType=service.serviceOptions?.[0] || 'general' ; %>
                                                                           <%= serviceIcons[serviceType.toLowerCase()] || '🐾' %>
                                                                                <span class="ml-1 hidden sm:inline">
                                                                                     <%= serviceType %>
                                                                                </span>
                                                                 </span>
                                                            </div>
                                        </div>

                                        <!-- Content Section -->
                                        <div class="flex-1 p-3 sm:p-4 flex flex-col">
                                             <div class="flex items-start justify-between gap-2">
                                                  <!-- Title and Rating -->
                                                  <div class="flex-1">
                                                       <h3 class="text-base sm:text-lg font-semibold text-gray-900 group-hover:text-blue-600 
                                                    transition-colors line-clamp-1">
                                                            <%= service.serviceName || service.serviceOptions?.[0] || 'Service' %>
                                                       </h3>
                                                       <div class="flex items-center gap-2 mt-1">
                                                            <div class="flex items-center">
                                                                 <% const rating=service.rating || 4.9 %>
                                                                      <span class="text-sm font-medium text-gray-900">
                                                                           <%= rating %>
                                                                      </span>
                                                                      <svg class="w-4 h-4 text-yellow-400 ml-1" fill="currentColor" viewBox="0 0 20 20">
                                                                           <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                                      </svg>
                                                            </div>
                                                            <span class="text-gray-400">•</span>
                                                            <span class="text-sm text-gray-500">
                                                                 <%= service.reviewsCount || '12' %> avis
                                                            </span>
                                                       </div>
                                                  </div>

                                                  <!-- Price -->
                                                  <div class="text-right">
                                                       <div class="text-base sm:text-lg font-semibold text-gray-900">
                                                            <%= service.priceRange ? `${service.priceRange} DH` : 'N/A' %>
                                                       </div>
                                                       <div class="text-xs text-gray-500">par séance</div>
                                                  </div>
                                             </div>

                                             <!-- Location and Additional Info -->
                                             <div class="mt-2 sm:mt-3 flex items-center gap-3 text-sm text-gray-500">
                                                  <div class="flex items-center gap-1">
                                                       <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                                       </svg>
                                                       <span class="line-clamp-1">
                                                            <%= service.location || 'Non spécifié' %>
                                                       </span>
                                                  </div>
                                                  <span class="hidden sm:inline text-gray-300">•</span>
                                                  <span class="hidden sm:inline text-gray-500">
                                                       Disponible <%= service.availability || 'sur rendez-vous' %>
                                                  </span>
                                             </div>

                                             <!-- Provider Info -->
                                             <div class="mt-auto pt-3 flex items-center gap-2">
                                                  <img src="<%= service.createdBy?.profileImage || '/default-avatar.png' %>" alt="Provider" class="w-6 h-6 rounded-full object-cover">
                                                  <span class="text-sm font-medium text-gray-900">
                                                       <%= service.createdBy?.displayName || 'Service Provider' %>
                                                  </span>
                                                  <% if (service.createdBy?.isVerified) { %>
                                                       <img src="https://img.icons8.com/?size=100&id=4vNqm6VhTbfY&format=png&color=FAB005" alt="Verified" class="w-4 h-4">
                                                       <% } %>
                                             </div>
                                        </div>
                                   </div>
                              </div>
                              <% }) %>
                    </div>
                    <% } else { %>
                         <div class="text-center py-12">
                              <div class="mb-4">
                                   <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                   </svg>
                              </div>
                              <h3 class="text-lg font-medium text-gray-900">Aucun service disponible</h3>
                              <p class="mt-1 text-gray-500">Aucun service n'est actuellement disponible dans cette catégorie.</p>
                         </div>
                         <% } %>
          </div>

          <style>
               /* Smooth transitions */
               .group {
                    cursor: pointer;
                    transform: translateZ(0);
               }

               /* Line clamp fallback */
               .line-clamp-1 {
                    display: -webkit-box;
                    -webkit-line-clamp: 1;
                    -webkit-box-orient: vertical;
                    overflow: hidden;
               }

               /* Touch-friendly sizing for mobile */
               @media (max-width: 640px) {
                    .group {
                         min-height: 120px;
                    }

                    .group:active {
                         transform: scale(0.98);
                    }
               }

               /* Image aspect ratio fix */
               .aspect-square {
                    aspect-ratio: 1;
               }
          </style>