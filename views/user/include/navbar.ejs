<!-- Navigation System -->
<nav class="fixed top-0 inset-x-0 z-40 bg-white border-b border-slate-200">
  <!-- Main Navigation -->
  <div class="max-w-7xl mx-auto">
      <div class="px-4 sm:px-6 lg:px-8">
          <!-- Desktop Nav -->
          <div class="flex h-16 items-center justify-between">
              <!-- Left Section -->
              <div class="flex items-center gap-8">
                  <!-- Mobile Menu Button -->
                  <button id="menuToggle" class="lg:hidden p-2 text-slate-700 hover:bg-slate-100 rounded-lg">
                      <i class="fas fa-bars text-lg"></i>
                  </button>
                  
                  <!-- Logo -->
                  <a href="/" class="flex items-center gap-2">
                      <span class="text-xl font-semibold text-slate-900">NDRESSILIK</span>
                  </a>

                  <!-- Desktop Menu Items -->
                  <div class="hidden lg:flex items-center gap-1">
                      <!-- Navigation Links -->
                      <div class="flex items-center gap-2">
                          <!-- Services Menu -->
                          <div class="relative group" data-dropdown="services">
                              <button class="flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100/80 rounded-lg">
                                  <span>Services</span>
                                  <i class="fas fa-chevron-down text-xs transition-transform group-data-[state=open]:rotate-180"></i>
                              </button>
                              
                              <!-- Services Dropdown -->
                              <div class="hidden absolute top-full left-0 mt-1 w-64 p-3 bg-white rounded-xl shadow-lg border border-slate-200/60">
                                  <div class="grid grid-cols-2 gap-2">
                                      <a href="/services/dressage" class="flex flex-col items-center gap-2 p-3 rounded-xl hover:bg-slate-50 transition-colors">
                                          <i class="fas fa-graduation-cap text-blue-600"></i>
                                          <span class="text-sm font-medium text-slate-700">Dressage</span>
                                      </a>
                                      <a href="/services/toilettage" class="flex flex-col items-center gap-2 p-3 rounded-xl hover:bg-slate-50 transition-colors">
                                          <i class="fas fa-cut text-blue-600"></i>
                                          <span class="text-sm font-medium text-slate-700">Toilettage</span>
                                      </a>
                                      <a href="/services/pension" class="flex flex-col items-center gap-2 p-3 rounded-xl hover:bg-slate-50 transition-colors">
                                          <i class="fas fa-home text-blue-600"></i>
                                          <span class="text-sm font-medium text-slate-700">Pension</span>
                                      </a>
                                      <a href="/services/veterinaire" class="flex flex-col items-center gap-2 p-3 rounded-xl hover:bg-slate-50 transition-colors">
                                          <i class="fas fa-stethoscope text-blue-600"></i>
                                          <span class="text-sm font-medium text-slate-700">Vétérinaire</span>
                                      </a>
                                  </div>
                              </div>
                          </div>

                          <!-- Simple Links -->
                          <a href="/articles" class="px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100/80 rounded-lg transition-colors">
                              Articles
                          </a>
                          <a href="/professionnels" class="px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100/80 rounded-lg transition-colors">
                              Experts
                          </a>
                          <a href="/les-elevages" class="px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100/80 rounded-lg transition-colors">
                              Élevages
                          </a>
                      </div>
                  </div>
              </div>

              <!-- Right Section -->
              <div class="flex items-center gap-3">
                  <!-- Add Service Button -->
                  <% if (user) { %>
                      <a href="/dashboard/new-service" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                          <i class="fas fa-plus text-sm"></i>
                          <span>Ajouter</span>
                      </a>
                  <% } else { %>
                      <button onclick="showLoginModal()" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                          <i class="fas fa-plus text-sm"></i>
                          <span>Ajouter</span>
                      </button>
                  <% } %>

                  <!-- User Menu -->
                  <div class="relative" data-dropdown="user">
                      <button class="flex items-center gap-2 p-1.5 hover:bg-slate-100/80 rounded-lg transition-colors">
                          <% if (user) { %>
                              <img src="<%= user.profileImage || '/default-avatar.png' %>" 
                                   alt="Profile" 
                                   class="h-8 w-8 rounded-lg object-cover ring-2 ring-white">
                          <% } else { %>
                              <i class="fas fa-user-circle text-2xl text-slate-400"></i>
                          <% } %>
                      </button>

                      <!-- User Dropdown -->
                      <div class="hidden absolute right-0 mt-2 w-72 p-2 bg-white rounded-xl shadow-lg border border-slate-200/60">
                          <% if (user) { %>
                              <!-- User Info -->
                              <div class="p-3">
                                  <div class="flex items-center gap-3">
                                      <img src="<%= user.profileImage || '/default-avatar.png' %>" 
                                           alt="Profile"
                                           class="h-12 w-12 rounded-lg object-cover ring-2 ring-white">
                                      <div class="flex-1 min-w-0">
                                          <div class="font-medium text-slate-900 truncate"><%= user.displayName %></div>
                                          <div class="text-sm text-slate-500 truncate"><%= user.email %></div>
                                      </div>
                                  </div>
                              </div>

                              <!-- Menu Items -->
                              <div class="mt-2 border-t border-slate-200/60">
                                  <div class="py-2">
                                      <a href="/dashboard" class="flex items-center gap-3 px-3 py-2 text-slate-700 hover:text-slate-900 hover:bg-slate-50 rounded-lg">
                                          <i class="fas fa-grid text-blue-600"></i>
                                          <span>Dashboard</span>
                                      </a>
                                      <a href="/mes-services" class="flex items-center gap-3 px-3 py-2 text-slate-700 hover:text-slate-900 hover:bg-slate-50 rounded-lg">
                                          <i class="fas fa-list text-blue-600"></i>
                                          <span>Mes Services</span>
                                      </a>
                                      <a href="/profile" class="flex items-center gap-3 px-3 py-2 text-slate-700 hover:text-slate-900 hover:bg-slate-50 rounded-lg">
                                          <i class="fas fa-user text-blue-600"></i>
                                          <span>Profile</span>
                                      </a>
                                  </div>
                                  <div class="py-2 border-t border-slate-200/60">
                                      <a href="/logout" class="flex items-center gap-3 px-3 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg">
                                          <i class="fas fa-sign-out-alt"></i>
                                          <span>Déconnexion</span>
                                      </a>
                                  </div>
                              </div>
                          <% } else { %>
                              <a href="/auth/google" class="flex items-center gap-3 p-3 text-slate-700 hover:bg-slate-50 rounded-lg">
                                  <i class="fab fa-google text-xl"></i>
                                  <div class="flex-1">
                                      <div class="font-medium">Continuer avec Google</div>
                                      <div class="text-sm text-slate-500">Connectez-vous pour accéder à plus</div>
                                  </div>
                              </a>
                          <% } %>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <!-- Mobile Sidebar -->
  <div id="mobileSidebar" class="fixed inset-0 z-50 lg:hidden">
      <!-- Backdrop -->
      <div class="absolute inset-0 bg-slate-900/20 backdrop-blur-sm opacity-0 transition-opacity duration-300"></div>

      <!-- Content -->
      <div class="absolute inset-y-0 left-0 w-80 bg-white -translate-x-full transition-transform duration-300">
          <!-- Header -->
          <div class="p-4 border-b border-slate-200/60">
              <% if (user) { %>
                  <div class="flex items-center gap-3 mb-4">
                      <img src="<%= user.profileImage || '/default-avatar.png' %>" 
                           alt="Profile"
                           class="h-12 w-12 rounded-lg object-cover ring-2 ring-white">
                      <div class="flex-1 min-w-0">
                          <div class="font-medium text-slate-900 truncate"><%= user.displayName %></div>
                          <div class="text-sm text-slate-500 truncate"><%= user.email %></div>
                      </div>
                  </div>
                  <a href="/dashboard/new-service" class="flex items-center justify-center gap-2 w-full p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors">
                      <i class="fas fa-plus text-sm"></i>
                      <span class="font-medium">Ajouter un service</span>
                  </a>
              <% } else { %>
                  <a href="/auth/google" class="flex items-center gap-3 p-3 border-2 border-slate-200 rounded-xl hover:border-blue-600 transition-colors">
                      <i class="fab fa-google text-xl text-slate-400"></i>
                      <div class="flex-1">
                          <div class="font-medium text-slate-900">Continuer avec Google</div>
                          <div class="text-sm text-slate-500">Connectez-vous pour accéder à plus</div>
                      </div>
                  </a>
              <% } %>
          </div>

          <!-- Navigation -->
          <div class="p-4">
              <div class="space-y-1">
                  <% if (user) { %>
                      <a href="/dashboard" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                          <i class="fas fa-grid text-blue-600"></i>
                          <span class="font-medium">Dashboard</span>
                      </a>
                      <a href="/mes-services" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                          <i class="fas fa-list text-blue-600"></i>
                          <span class="font-medium">Mes Services</span>
                      </a>
                  <% } %>

                  <div class="pt-4">
                      <div class="px-4 text-xs font-semibold text-slate-400 uppercase tracking-wider">Services</div>
                      <div class="mt-3 space-y-1">
                          <a href="/services/dressage" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                              <i class="fas fa-graduation-cap text-blue-600"></i>
                              <span class="font-medium">Dressage</span>
                          </a>
                          <a href="/services/toilettage" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                              <i class="fas fa-cut text-blue-600"></i>
                              <span class="font-medium">Toilettage</span>
                          </a>
                          <a href="/services/pension" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                              <i class="fas fa-home text-blue-600"></i>
                              <span class="font-medium">Pension</span>
                          </a>
                          <a href="/services/veterinaire" class="flex items-center gap-3 px-4 py-3 text-slate-600 hover:text-slate-900 hover:bg-slate-50 rounded-xl">
                              <i class="fas fa-stethoscope text-blue-600"></i>
                              <span class="font-medium">Vétérinaire</span>
                          </a>
                      </div>
                  </div>
              </div>
          </div>

          <!-- Close Button -->
          <button id="closeSidebar" class="absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg">
              <i class="fas fa-times text-xl"></i>
          </button>
      </div>
  </div>
</nav>

<!-- Login Modal (continuation) -->
<div id="loginModal" class="fixed inset-0 z-50 hidden">
  <div class="min-h-screen px-4 text-center">
      <!-- Modal Backdrop -->
      <div class="fixed inset-0 bg-slate-900/20 backdrop-blur-sm transition-opacity"></div>

      <!-- Modal Positioning -->
      <div class="inline-block w-full max-w-md p-6 my-8 text-left align-middle bg-white rounded-2xl shadow-xl transform transition-all">
          <!-- Modal Content -->
          <div class="flex flex-col items-center">
              <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mb-4">
                  <i class="fas fa-user text-2xl text-blue-600"></i>
              </div>
              
              <h3 class="text-xl font-semibold text-slate-900 mb-2">Connectez-vous</h3>
              <p class="text-slate-600 text-center mb-6">
                  Accédez à toutes les fonctionnalités et gérez vos services
              </p>
              
              <a href="/auth/google" 
                 class="flex items-center justify-center gap-3 w-full p-4 bg-white border-2 border-slate-200 
                        rounded-xl hover:border-blue-600 hover:bg-slate-50 transition-all duration-200">
                  <i class="fab fa-google text-xl text-slate-600"></i>
                  <span class="font-medium text-slate-900">Continuer avec Google</span>
              </a>

              <button onclick="hideLoginModal()" 
                      class="mt-6 text-sm text-slate-600 hover:text-slate-900">
                  Fermer
              </button>
          </div>
      </div>
  </div>
</div>

<style>
/* Custom Animations */
@keyframes slideDown {
  from {
      opacity: 0;
      transform: translateY(-10px);
  }
  to {
      opacity: 1;
      transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Animation Classes */
.animate-slide-down {
  animation: slideDown 0.3s ease-out;
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Dropdown Menu Transitions */
.dropdown-enter {
  opacity: 0;
  transform: translateY(-10px);
  pointer-events: none;
}

.dropdown-enter-active {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
  transition: opacity 0.2s, transform 0.2s;
}

/* Mobile Sidebar Transitions */
.sidebar-visible {
  pointer-events: auto;
}

.sidebar-visible .backdrop {
  opacity: 1;
}

.sidebar-visible .content {
  transform: translateX(0);
}
</style>

<script>
// Dropdown Management
document.addEventListener('DOMContentLoaded', function() {
  // Dropdown Toggle Handler
  const dropdowns = document.querySelectorAll('[data-dropdown]');
  dropdowns.forEach(dropdown => {
      const button = dropdown.querySelector('button');
      const menu = dropdown.querySelector('.hidden');
      
      button.addEventListener('click', (e) => {
          e.stopPropagation();
          closeAllDropdowns();
          toggleDropdown(menu);
      });
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', () => {
      closeAllDropdowns();
  });

  function toggleDropdown(menu) {
      if (menu.classList.contains('hidden')) {
          menu.classList.remove('hidden');
          menu.classList.add('dropdown-enter');
          requestAnimationFrame(() => {
              menu.classList.remove('dropdown-enter');
              menu.classList.add('dropdown-enter-active');
          });
      } else {
          closeDropdown(menu);
      }
  }

  function closeDropdown(menu) {
      menu.classList.remove('dropdown-enter-active');
      menu.classList.add('dropdown-enter');
      setTimeout(() => {
          menu.classList.add('hidden');
      }, 200);
  }

  function closeAllDropdowns() {
      document.querySelectorAll('[data-dropdown] .dropdown-enter-active').forEach(menu => {
          closeDropdown(menu);
      });
  }
});

// Mobile Sidebar Management
const sidebar = document.getElementById('mobileSidebar');
const sidebarContent = sidebar.querySelector('.absolute.inset-y-0');
const backdrop = sidebar.querySelector('.absolute.inset-0');

function openSidebar() {
  sidebar.classList.add('sidebar-visible');
  document.body.style.overflow = 'hidden';
}

function closeSidebar() {
  sidebar.classList.remove('sidebar-visible');
  document.body.style.overflow = '';
}

document.getElementById('menuToggle').addEventListener('click', openSidebar);
document.getElementById('closeSidebar').addEventListener('click', closeSidebar);
backdrop.addEventListener('click', closeSidebar);

// Login Modal Management
function showLoginModal() {
  const modal = document.getElementById('loginModal');
  modal.classList.remove('hidden');
  document.body.style.overflow = 'hidden';
  
  // Animate modal entrance
  const modalContent = modal.querySelector('.transform');
  modalContent.style.transform = 'scale(0.95)';
  modalContent.style.opacity = '0';
  
  requestAnimationFrame(() => {
      modalContent.style.transform = 'scale(1)';
      modalContent.style.opacity = '1';
  });
}

function hideLoginModal() {
  const modal = document.getElementById('loginModal');
  const modalContent = modal.querySelector('.transform');
  
  modalContent.style.transform = 'scale(0.95)';
  modalContent.style.opacity = '0';
  
  setTimeout(() => {
      modal.classList.add('hidden');
      document.body.style.overflow = '';
  }, 200);
}

// Scroll Handler for Navbar
let lastScrollY = window.scrollY;
const nav = document.querySelector('nav');

window.addEventListener('scroll', () => {
  if (window.scrollY > 20) {
      nav.classList.add('shadow-sm', 'bg-white/95', 'backdrop-blur-md');
  } else {
      nav.classList.remove('shadow-sm', 'bg-white/95', 'backdrop-blur-md');
  }
  
  lastScrollY = window.scrollY;
});

// Escape Key Handler
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
      closeAllDropdowns();
      closeSidebar();
      hideLoginModal();
  }
});

// Handle Mobile Back Button
window.addEventListener('popstate', () => {
  closeAllDropdowns();
  closeSidebar();
  hideLoginModal();
});
// Mobile Menu JavaScript
const mobileMenu = {
    init() {
        // Elements
        this.menuButton = document.getElementById('menuToggle');
        this.sidebar = document.getElementById('mobileSidebar');
        this.closeButton = document.getElementById('closeSidebar');
        this.backdrop = this.sidebar.querySelector('.bg-slate-900\\/20');
        this.sidebarContent = this.sidebar.querySelector('.absolute.inset-y-0');
        
        // Event Listeners
        this.menuButton.addEventListener('click', () => this.open());
        this.closeButton.addEventListener('click', () => this.close());
        this.backdrop.addEventListener('click', () => this.close());
        
        // Initialize state
        this.sidebar.style.display = 'none';
    },
    
    open() {
        // Show sidebar
        this.sidebar.style.display = 'block';
        document.body.style.overflow = 'hidden';
        
        // Animate in
        requestAnimationFrame(() => {
            this.backdrop.style.opacity = '1';
            this.sidebarContent.style.transform = 'translateX(0)';
        });
    },
    
    close() {
        // Animate out
        this.backdrop.style.opacity = '0';
        this.sidebarContent.style.transform = 'translateX(-100%)';
        
        // Hide after animation
        setTimeout(() => {
            this.sidebar.style.display = 'none';
            document.body.style.overflow = '';
        }, 300);
    }
};

// Initialize mobile menu on page load
document.addEventListener('DOMContentLoaded', () => {
    mobileMenu.init();
});

// Update the styles
document.head.insertAdjacentHTML('beforeend', `
<style>
    /* Mobile Sidebar Transitions */
    #mobileSidebar .bg-slate-900\\/20 {
        transition: opacity 0.3s ease-out;
    }
    
    #mobileSidebar .absolute.inset-y-0 {
        transition: transform 0.3s ease-out;
    }
    
    /* Ensure content is hidden by default */
    #mobileSidebar {
        display: none;
    }
    
    /* Remove default -translate-x-full class */
    #mobileSidebar .absolute.inset-y-0 {
        transform: translateX(-100%);
    }
</style>
`);
</script>
<div class="h-10"></div>
