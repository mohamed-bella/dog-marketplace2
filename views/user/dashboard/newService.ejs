<!DOCTYPE html>
<html lang="fr">

<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Cr√©er un Nouveau Service</title>

     <!-- Essential Styles -->
     <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
     <link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
     <link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

     <!-- Additional Styles -->
     <style>
          .loading-spinner {
               display: inline-block;
               width: 1.5rem;
               height: 1.5rem;
               border: 3px solid rgba(255, 255, 255, .3);
               border-radius: 50%;
               border-top-color: #fff;
               animation: spin 1s ease-in-out infinite;
          }

          @keyframes spin {
               to {
                    transform: rotate(360deg);
               }
          }

          /* Custom Styles */
          body {
               background-color: #f9fafb;
          }

          .step-indicator {
               transition: background-color 0.3s, color 0.3s;
          }

          .step-indicator-active {
               background-color: #2563eb;
               color: white;
          }

          .service-option {
               transition: border-color 0.3s, background-color 0.3s;
          }

          .service-option-selected {
               border-color: #2563eb;
               background-color: #eff6ff;
          }

          .input-focus {
               border-color: #2563eb;
          }

          .button-primary {
               background-color: #2563eb;
               color: white;
               transition: background-color 0.3s;
          }

          .button-primary:hover {
               background-color: #1d4ed8;
          }

          .hidden {
               display: none;
          }
     </style>
</head>


<body class="font-sans antialiased">
     <!-- Define variables first -->
     <% const steps=['Type de Service', 'D√©tails' , 'Photos' ]; const services=[ { id: 'dressage' , name: 'Dressage' , icon: 'üêï' }, { id: 'toilettage' , name: 'Toilettage' , icon: '‚úÇÔ∏è' }, { id: 'promenade' , name: 'Promenade' , icon: 'üö∂' }, { id: 'veterinaire' , name: 'V√©t√©rinaire' , icon: 'ü©∫' }, { id: 'pension' , name: 'Pension' , icon: 'üè†' }, { id: 'transport' , name: 'Transport' , icon: 'üöó' } ]; const cities=[ 'Casablanca - ÿßŸÑÿØÿßÿ± ÿßŸÑÿ®Ÿäÿ∂ÿßÿ°' , 'Rabat - ÿßŸÑÿ±ÿ®ÿßÿ∑' , 'Sal√© - ÿ≥ŸéŸÑŸéÿß', 'Marrakech - ŸÖÿ±ÿßŸÉÿ¥' , 'Agadir - ÿ£ŸÉÿßÿØŸäÿ±' , 'Tanger - ÿ∑ŸÜÿ¨ÿ©' , 'F√®s - ŸÅÿßÿ≥' , 'T√©touan - ÿ™ÿ∑ŸàÿßŸÜ' , 'Mekn√®s - ŸÖŸÉŸÜÿßÿ≥' , 'Oujda - Ÿàÿ¨ÿØÿ©' , 'Asfi - ÿ¢ÿ≥ŸÅŸä' , 'Kenitra - ÿßŸÑŸÇŸÜŸäÿ∑ÿ±ÿ©' , 'Mohamm√©dia - ÿßŸÑŸÖÿ≠ŸÖÿØŸäÿ©' , 'La√¢youne - ÿßŸÑÿπŸäŸàŸÜ' , 'B√©ni Mellal - ÿ®ŸÜŸä ŸÖŸÑÿßŸÑ' , 'Nador - ÿßŸÑŸÜÿßÿ∏Ÿàÿ±' , 'Settat - ÿ≥ÿ∑ÿßÿ™' , 'Safi - ÿßŸÑÿµŸàŸäÿ±ÿ©' , 'Errachidia - ÿßŸÑÿ±ÿ¥ŸäÿØŸäÿ©' , 'Khouribga - ÿÆÿ±Ÿäÿ®ŸÉÿ©' , 'El Jadida - ÿßŸÑÿ¨ÿØŸäÿØÿ©' , 'Taza - ÿ™ÿßÿ≤ÿ©' , 'Ksar El-K√©bir - ÿßŸÑŸÇÿµÿ± ÿßŸÑŸÉÿ®Ÿäÿ±' , 'Larache - ÿßŸÑÿπÿ±ÿßÿ¶ÿ¥' , 'Berkane - ÿ®ÿ±ŸÉÿßŸÜ' , 'Taourirt - ÿ™ÿßŸàÿ±Ÿäÿ±ÿ™' , 'Guercif - ÿ¨ÿ±ÿ≥ŸäŸÅ' , 'Youssoufia - ÿßŸÑŸäŸàÿ≥ŸÅŸäÿ©' , 'Sidi Kacem - ÿ≥ŸäÿØŸä ŸÇÿßÿ≥ŸÖ' , 'Khenifra - ÿÆŸÜŸäŸÅÿ±ÿ©' , 'Guelmim - ŸÉŸÑŸÖŸäŸÖ' , 'Tan-Tan - ÿ∑ÿßŸÜÿ∑ÿßŸÜ' , 'Sidi Bennour - ÿ≥ŸäÿØŸä ÿ®ŸÜŸàÿ±' , 'Boujdour - ÿ®Ÿàÿ¨ÿØŸàÿ±' , 'Tarfaya - ÿ∑ÿ±ŸÅÿßŸäÿ©' , 'Azilal - ÿ£ÿ≤ŸäŸÑÿßŸÑ' , 'Chichaoua - ÿ¥Ÿäÿ¥ÿßŸàÿ©' , 'Fquih Ben Salah - ÿßŸÑŸÅŸÇŸäŸá ÿ®ŸÜ ÿµÿßŸÑÿ≠' , 'Taroudant - ÿ™ÿßÿ±ŸàÿØÿßŸÜÿ™' , 'Ouazzane - Ÿàÿ≤ÿßŸÜ' , 'Ifrane - ÿ•ŸÅÿ±ÿßŸÜ' , 'Sefrou - ÿµŸÅÿ±Ÿà' , 'Benslimane - ÿ®ŸÜÿ≥ŸÑŸäŸÖÿßŸÜ' , 'Midelt - ŸÖŸäÿØŸÑÿ™' , 'Al Hoceima - ÿßŸÑÿ≠ÿ≥ŸäŸÖÿ©' , 'Zagora - ÿ≤ÿßŸÉŸàÿ±ÿ©' , 'Ouarzazate - Ÿàÿ±ÿ≤ÿßÿ≤ÿßÿ™' , 'Sidi Ifni - ÿ≥ŸäÿØŸä ÿ•ŸÅŸÜŸä' , 'Boulemane - ÿ®ŸàŸÑŸÖÿßŸÜ' , 'Chefchaouen - ÿ¥ŸÅÿ¥ÿßŸàŸÜ' , 'Dakhla - ÿßŸÑÿØÿßÿÆŸÑÿ©' , 'Jerada - ÿ¨ÿ±ÿßÿØÿ©' , 'Fnideq - ÿßŸÑŸÅŸÜŸäÿØŸÇ' , 'Martil - ŸÖÿ±ÿ™ŸäŸÑ' , 'Sidi Slimane - ÿ≥ŸäÿØŸä ÿ≥ŸÑŸäŸÖÿßŸÜ' , 'Imintanoute - ÿ•ŸäŸÖŸäŸÜÿ™ÿßŸÜŸàÿ™' , 'Oulad Teima - ÿ£ŸàŸÑÿßÿØ ÿ™ÿßŸäŸÖÿ©' , 'Temara - ÿ™ŸÖÿßÿ±ÿ©' , 'El Hajeb - ÿßŸÑÿ≠ÿßÿ¨ÿ®' , 'Ait Melloul - ÿ£Ÿäÿ™ ŸÖŸÑŸàŸÑ' , 'Bouskoura - ÿ®Ÿàÿ≥ŸÉŸàÿ±ÿ©' , 'Ain Harrouda - ÿπŸäŸÜ ÿ≠ÿ±ŸàÿØÿ©' , 'Tit Mellil - ÿ™Ÿäÿ∑ ŸÖŸÑŸäŸÑ' , 'Ouled Tayeb - ÿ£ŸàŸÑÿßÿØ ÿ∑Ÿäÿ®' , 'Bouznika - ÿ®Ÿàÿ≤ŸÜŸäŸÇÿ©' , 'Sidi Bou Othmane - ÿ≥ŸäÿØŸä ÿ®Ÿàÿπÿ´ŸÖÿßŸÜ' , 'Ait Ourir - ÿ£Ÿäÿ™ ÿ£Ÿàÿ±Ÿäÿ±' , 'Dar Bouazza - ÿØÿßÿ± ÿ®Ÿàÿπÿ≤ÿ©' , 'Moulay Yacoub - ŸÖŸàŸÑÿßŸä ŸäÿπŸÇŸàÿ®' , 'Aghbala - ÿ£ÿ∫ÿ®ÿßŸÑÿ©' , 'Boumia - ÿ®ŸàŸÖŸäÿ©' , 'Asilah - ÿ£ÿµŸäŸÑÿ©' , 'Anza - ÿ£ŸÜÿ≤ÿß' , 'Inezgane - ÿ•ŸÜÿ≤ŸÉÿßŸÜ' , 'Tiznit - ÿ™ÿ≤ŸÜŸäÿ™' , 'Skhirat - ÿßŸÑÿµÿÆŸäÿ±ÿßÿ™' , 'Sidi Yahya El Gharb - ÿ≥ŸäÿØŸä Ÿäÿ≠ŸäŸâ ÿßŸÑÿ∫ÿ±ÿ®' , 'Bouarfa - ÿ®Ÿàÿπÿ±ŸÅÿ©' , 'Tinghir - ÿ™ŸÜÿ∫Ÿäÿ±' , 'Zaio - ÿ≤ÿßŸäŸà' , 'Ahfir - ÿ£ÿ≠ŸÅŸäÿ±' , 'Sidi Allal Tazi - ÿ≥ŸäÿØŸä ÿπŸÑÿßŸÑ ÿßŸÑÿ™ÿßÿ≤Ÿä' , 'Ben Guerir - ÿ®ŸÜ ÿ¨ÿ±Ÿäÿ±' , 'Jorf Lasfar - ÿßŸÑÿ¨ÿ±ŸÅ ÿßŸÑÿ£ÿµŸÅÿ±' , 'Dar Gueddari - ÿØÿßÿ± ÿßŸÑŸÉÿØÿßÿ±Ÿä' , 'Sidi Taibi - ÿ≥ŸäÿØŸä ÿßŸÑÿ∑Ÿäÿ®Ÿä' , 'Sidi Bennour - ÿ≥ŸäÿØŸä ÿ®ŸÜŸàÿ±' , 'Aourir - ÿ£Ÿàÿ±Ÿäÿ±' , 'Tamansourt - ÿ™ÿßŸÖŸÜÿ≥Ÿàÿ±ÿ™' , 'Had Soualem - ÿ≠ÿØ ÿßŸÑÿ≥ŸàÿßŸÑŸÖ' , 'Beni Yakhlef - ÿ®ŸÜŸä ŸäÿÆŸÑŸÅ' , 'Massa - ŸÖÿ≥ÿ©' , 'Sidi Rahal - ÿ≥ŸäÿØŸä ÿ±ÿ≠ÿßŸÑ' , 'Demnate - ÿØŸÖŸÜÿßÿ™' , 'Bouznika - ÿ®Ÿàÿ≤ŸÜŸäŸÇÿ©' , 'Tamellalt - ÿ™ŸÖŸÑÿßŸÑÿ™' , 'Bouabout Ait Boufoulen - ÿ®Ÿàÿπÿ®ŸàÿØ ÿ£Ÿäÿ™ ÿ®ŸàŸÅŸàŸÑŸÜ' , 'Oulad Ayad - ÿ£ŸàŸÑÿßÿØ ÿπŸäÿßÿØ' , 'El Kelaa des Sraghna - ŸÇŸÑÿπÿ© ÿßŸÑÿ≥ÿ±ÿßÿ∫ŸÜÿ©' , 'Beja√¢d - ÿ®ÿ¶ÿ± ÿßŸÑÿ≠ÿØ' , 'Tamesna - ÿ™ÿßŸÖÿ≥ŸÜÿß' , 'El Borouj - ÿßŸÑÿ®ÿ±Ÿàÿ¨' , 'Ouled Frej - ÿ£ŸàŸÑÿßÿØ ŸÅÿ±ÿ¨' , 'Moulay Bousselham - ŸÖŸàŸÑÿßŸä ÿ®Ÿàÿ≥ŸÑŸáÿßŸÖ' , 'Azemmour - ÿ£ÿ≤ŸÖŸàÿ±' , 'Bni Tadjite - ÿ®ŸÜŸä ÿ™ÿ¨Ÿäÿ™' , 'Ait Baha - ÿ£Ÿäÿ™ ÿ®Ÿáÿß' , 'Sidi Yahya Zaer - ÿ≥ŸäÿØŸä Ÿäÿ≠ŸäŸâ ÿ≤ÿπŸäÿ±' , 'Sidi Moussa - ÿ≥ŸäÿØŸä ŸÖŸàÿ≥Ÿâ' ];%>
          <div class="min-h-screen bg-transparent sm:bg-gray-50 py-8">
               <div class="container max-w-4xl mx-auto px-4">
                    <!-- Back to Dashboard Button -->
                    <a href="/dashboard" class="inline-flex items-center text-gray-600 hover:text-gray-900 mb-8 group transition-all">
                         <svg class="w-5 h-5 mr-2 transform transition-transform group-hover:-translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                         </svg>
                         Retour au tableau de bord
                    </a>

                    <!-- Main Content Card -->
                    <div class="bg-transparent rounded-2xl shadow-sm sm:p-8">
                         <!-- Header -->
                         <div class="text-center mb-10">
                              <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Cr√©er un Nouveau Service</h1>
                              <p class="mt-2 text-gray-600">Partagez vos comp√©tences avec la communaut√©</p>
                         </div>

                         <!-- Progress Steps -->
                         <div class="relative mb-12">
                              <div class="absolute left-0 right-0 top-1/2 h-0.5 bg-gray-200 -translate-y-1/2"></div>
                              <div class="relative flex justify-between max-w-2xl mx-auto px-4">
                                   <% steps.forEach((step, index)=> { %>
                                        <div class="flex flex-col items-center">
                                             <div class="relative z-10 w-10 h-10 rounded-full bg-white border-2 border-gray-300 
                            flex items-center justify-center step-indicator transition-all duration-300" data-step="<%= index + 1 %>">
                                                  <span class="text-gray-600 font-medium">
                                                       <%= index + 1 %>
                                                  </span>
                                             </div>
                                             <span class="mt-2 text-sm font-medium text-gray-600 hidden sm:block">
                                                  <%= step %>
                                             </span>
                                        </div>
                                        <% }); %>
                              </div>
                         </div>

                         <!-- Form -->
                         <form id="serviceForm" class="max-w-2xl mx-auto space-y-8">
                              <!-- Step 1: Service Type -->
                              <div class="step" data-step="1">
                                   <div class="mb-4">
                                        <p class="text-gray-700">Veuillez s√©lectionner le type de service que vous souhaitez offrir¬†:</p>
                                   </div>
                                   <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                                        <% services.forEach(service=> { %>
                                             <label class="service-option cursor-pointer group">
                                                  <input type="radio" name="serviceType" value="<%= service.id %>" class="absolute opacity-0 w-0 h-0" required>
                                                  <div class="relative p-4 rounded-xl border-2 border-gray-200 
                                transition-all duration-200 hover:border-blue-200
                                group-[.selected]:border-blue-500 group-[.selected]:bg-blue-50">
                                                       <div class="flex flex-col items-center text-center gap-3">
                                                            <span class="text-3xl transform transition-transform duration-200 
                                        group-hover:scale-110">
                                                                 <%= service.icon %>
                                                            </span>
                                                            <span class="font-medium text-gray-900">
                                                                 <%= service.name %>
                                                            </span>
                                                       </div>
                                                       <!-- Checkmark Indicator -->
                                                       <div class="absolute top-3 right-3 opacity-0 transform scale-0 
                                    transition-all duration-200 group-[.selected]:opacity-100 
                                    group-[.selected]:scale-100">
                                                            <svg class="w-5 h-5 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                                                                 <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" />
                                                            </svg>
                                                       </div>
                                                  </div>
                                             </label>
                                             <% }); %>
                                   </div>
                              </div>

                              <!-- Step 2: Service Details  -->
                              <div class="step hidden" data-step="2">
                                   <div class="space-y-8">
                                        <!-- Service Name Input -->
                                        <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md">
                                             <label class="flex items-center text-lg font-semibold text-gray-800 mb-3">
                                                  <span class="text-2xl mr-2">‚ú®</span>
                                                  Donnez un nom √† votre service
                                             </label>
                                             <div class="relative">
                                                  <input type="text" name="serviceName" placeholder="Ex: Dressage expert pour chiens de compagnie" class="w-full px-6 py-5 text-lg rounded-xl border-2 border-gray-200 
                                                       bg-gray-50 focus:bg-white
                                                       focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 
                                                       transition-all duration-300 placeholder-gray-400" required>
                                                  <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400">
                                                       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                                       </svg>
                                                  </div>
                                             </div>
                                             <p class="mt-3 text-base text-gray-600">Un bon nom attire plus de clients! üéØ</p>
                                        </div>

                                        <!-- Price Input -->
                                        <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md">
                                             <label class="flex items-center text-lg font-semibold text-gray-800 mb-3">
                                                  <span class="text-2xl mr-2">üí∞</span>
                                                  Quel est votre tarif?
                                             </label>
                                             <div class="relative">
                                                  <input type="number" name="minPrice" placeholder="200" min="0" class="w-full px-6 py-5 text-lg rounded-xl border-2 border-gray-200 
                                                       bg-gray-50 focus:bg-white pr-16
                                                       focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 
                                                       transition-all duration-300 placeholder-gray-400" required>
                                                  <span class="absolute right-6 top-1/2 -translate-y-1/2 text-gray-700 font-semibold text-lg">
                                                       DH
                                                  </span>
                                             </div>
                                             <p class="mt-3 text-base text-gray-600">Prix minimum pour votre service üìä</p>
                                        </div>

                                        <!-- Location Select -->
                                        <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md">
                                             <label class="flex items-center text-lg font-semibold text-gray-800 mb-3">
                                                  <span class="text-2xl mr-2">üìç</span>
                                                  Dans quelle ville proposez-vous vos services?
                                             </label>
                                             <div class="relative">
                                                  <select name="location" class="w-full px-6 py-5 text-lg rounded-xl border-2 border-gray-200 
                                                        bg-gray-50 focus:bg-white appearance-none
                                                        focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 
                                                        transition-all duration-300" required>
                                                       <option value="">Choisissez votre ville</option>
                                                       <% cities.forEach(city=> { %>
                                                            <option value="<%= city.toLowerCase() %>">
                                                                 <%= city %>
                                                            </option>
                                                            <% }); %>
                                                  </select>
                                                  <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
                                                       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path d="M19 9l-7 7-7-7" />
                                                       </svg>
                                                  </div>
                                             </div>
                                             <p class="mt-3 text-base text-gray-600">Zone de couverture de vos services üó∫Ô∏è</p>
                                        </div>

                                        <!-- Description Textarea -->
                                        <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md">
                                             <label class="flex items-center text-lg font-semibold text-gray-800 mb-3">
                                                  <span class="text-2xl mr-2">üìù</span>
                                                  D√©crivez votre service en d√©tail
                                             </label>
                                             <div class="relative">
                                                  <textarea name="description" rows="6" placeholder="Partagez votre exp√©rience, vos m√©thodes, et ce qui rend votre service unique..." class="w-full px-6 py-5 text-lg rounded-xl border-2 border-gray-200 
                                                          bg-gray-50 focus:bg-white
                                                          focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 
                                                          transition-all duration-300 resize-none placeholder-gray-400" required></textarea>
                                                  <div class="absolute right-4 top-4 text-gray-400">
                                                       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                                       </svg>
                                                  </div>
                                             </div>
                                             <p class="mt-3 text-base text-gray-600">
                                                  Soyez d√©taill√© et pr√©cis pour attirer plus de clients! üåü
                                                  <span class="block mt-2 text-sm text-gray-500">
                                                       Astuce: Mentionnez votre exp√©rience, vos certifications, et ce qui vous diff√©rencie.
                                                  </span>
                                             </p>
                                        </div>
                                   </div>
                              </div>

                              <!-- Step 3: Number and Photos -->

                              <div class="step hidden" data-step="3">
                                   <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md">
                                        <label class="flex items-center text-lg font-semibold text-gray-800 mb-3">
                                             <span class="text-2xl mr-2">üì±</span>
                                             Comment peuvent-ils vous contacter?
                                        </label>
                                        <div class="relative group">
                                             <div class="absolute left-6 top-1/2 -translate-y-1/2 text-gray-500 font-medium">
                                                  +212
                                             </div>
                                             <input type="tel" name="serviceNumber" placeholder="6XX-XXX-XXX" class="w-full pl-20 pr-6 py-5 text-lg rounded-xl border-2 border-gray-200 
                                                                 bg-gray-50 focus:bg-white
                                                                 focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 
                                                                 transition-all duration-300 placeholder-gray-400" pattern="[0-9]{9}" maxlength="9" required>
                                             <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400">
                                                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                       <path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                                  </svg>
                                             </div>
                                             <div class="phone-format-guide hidden group-hover:block absolute -bottom-8 left-0 text-sm text-gray-500">
                                                  Format: 6XX-XXX-XXX
                                             </div>
                                        </div>
                                        <p class="mt-3 text-base text-gray-600">Votre num√©ro sera visible uniquement aux clients int√©ress√©s üîí</p>
                                   </div>

                                   <div class="form-group bg-white p-6 rounded-2xl shadow-sm border border-gray-100 transition-all duration-300 hover:shadow-md mt-2">
                                        <label class="block text-gray-700 mb-2">Photos du Service</label>
                                        <input type="file" class="filepond" name="serviceImages" multiple data-max-file-size="5MB" data-max-files="5" accept="image/*, image/heic, image/heif">
                                        <p class="text-sm text-gray-500 mt-2">Ajoutez jusqu'√† 5 photos (maximum 5MB par photo).</p>
                                        <p class="text-sm text-gray-500">Formats accept√©s¬†: JPG, PNG, GIF.</p>
                                   </div>
                              </div>

                              <!-- Navigation Buttons -->
                              <div class="flex items-center justify-between pt-6 border-t">
                                   <button type="button" id="prevBtn" class="hidden px-6 py-3 text-gray-700 bg-white border border-gray-300 
                    rounded-lg hover:bg-gray-50 transition-all duration-200">
                                        Pr√©c√©dent
                                   </button>
                                   <button type="button" id="nextBtn" class="ml-auto px-6 py-3 bg-blue-600 text-white rounded-lg 
                    hover:bg-blue-700 transition-all duration-200">
                                        Suivant
                                   </button>
                                   <button type="submit" id="submitBtn" class="hidden ml-auto px-6 py-3 bg-blue-600 text-white rounded-lg 
                    hover:bg-blue-700 transition-all duration-200">
                                        <span class="submit-text">Cr√©er le Service</span>
                                        <span class="loading-spinner hidden"></span>
                                   </button>
                              </div>
                         </form>
                    </div>
               </div>
          </div>


          <style>
               /* Active step styles */
               .step-indicator[data-active="true"] {
                    @apply border-blue-500 bg-blue-500 text-white;
               }

               /* Service option selection styles */
               .service-option input:checked+div {
                    @apply border-blue-500 bg-blue-50;
               }

               /* Animations */
               .step {
                    animation: fadeIn 0.3s ease-out;
               }

               @keyframes fadeIn {
                    from {
                         opacity: 0;
                         transform: translateY(10px);
                    }

                    to {
                         opacity: 1;
                         transform: translateY(0);
                    }
               }

               .loading-spinner {
                    animation: spin 1s linear infinite;
               }

               @keyframes spin {
                    from {
                         transform: rotate(0deg);
                    }

                    to {
                         transform: rotate(360deg);
                    }
               }
          </style>

          <script>
               // Service type selection handler
               document.querySelectorAll('.service-option').forEach(option => {
                    const input = option.querySelector('input');

                    input.addEventListener('change', () => {
                         // Remove selected class from all options
                         document.querySelectorAll('.service-option').forEach(opt => {
                              opt.classList.remove('selected');
                         });

                         // Add selected class to checked option
                         if (input.checked) {
                              option.classList.add('selected');
                         }
                    });
               });
          </script>
          <!-- Scripts -->
          <!-- Scripts -->
          <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
          <script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>
          <script src="https://unpkg.com/filepond-plugin-image-validate-size/dist/filepond-plugin-image-validate-size.js"></script>
          <script src="https://unpkg.com/filepond/dist/filepond.js"></script>

          <script>
               document.addEventListener('DOMContentLoaded', function () {
                    let currentStep = 1;
                    const totalSteps = 3;

                    // Elements
                    const steps = document.querySelectorAll('.step');
                    const stepIndicators = document.querySelectorAll('.step-indicator');
                    const prevBtn = document.getElementById('prevBtn');
                    const nextBtn = document.getElementById('nextBtn');
                    const submitBtn = document.getElementById('submitBtn');
                    const serviceOptions = document.querySelectorAll('.service-option');
                    const form = document.getElementById('serviceForm');

                    // Initialize FilePond
                    FilePond.registerPlugin(
                         FilePondPluginImagePreview,
                         FilePondPluginFileValidateType,
                         FilePondPluginImageValidateSize
                    );

                    const pond = FilePond.create(document.querySelector('.filepond'), {
                         allowMultiple: true,
                         maxFiles: 5,
                         maxFileSize: '8MB',
                         acceptedFileTypes: [
                              'image/jpeg',
                              'image/png',
                              'image/gif',
                              'image/heic',
                              'image/heif',
                              'image/webp'
                         ],
                         labelIdle: 'Glissez et d√©posez vos images ou <span class="filepond--label-action">Parcourir</span>',
                         labelMaxFileSize: 'Taille maximale de fichier: 5MB',
                         labelMaxFileSizeExceeded: 'Fichier trop volumineux',
                         labelFileTypeNotAllowed: 'Type de fichier invalide',
                         labelFileProcessing: 'T√©l√©chargement',
                         labelFileProcessingComplete: 'T√©l√©chargement termin√©',
                         labelFileProcessingAborted: 'T√©l√©chargement annul√©',
                         labelFileProcessingError: 'Erreur lors du t√©l√©chargement',
                         labelTapToCancel: 'Cliquez pour annuler',
                         server: {
                              process: {
                                   url: '/services/upload-temp',
                                   method: 'POST',
                                   onload: (response) => {

                                        const data = JSON.parse(response);
                                        return data.uploadedUrls[0].url;
                                   },
                                   onerror: (response) => {
                                        console.error('Upload error:', response);
                                        return response.data;
                                   }
                              }
                         }
                    });


                    // Functions
                    function showStep(step) {
                         steps.forEach((el, index) => {
                              el.classList.toggle('hidden', index !== step - 1);
                         });
                         updateStepIndicator(step);
                         updateNavigationButtons(step);
                    }

                    function updateNavigationButtons(step) {
                         prevBtn.classList.toggle('hidden', step === 1);
                         nextBtn.classList.toggle('hidden', step === totalSteps);
                         submitBtn.classList.toggle('hidden', step !== totalSteps);
                    }

                    function updateStepIndicator(step) {
                         stepIndicators.forEach((el, index) => {
                              el.classList.toggle('step-indicator-active', index === step - 1);
                              el.classList.toggle('border-blue-500', index <= step - 1);
                              el.classList.toggle('border-gray-300', index > step - 1);
                              el.querySelector('span').classList.toggle('text-white', index === step - 1);
                              el.querySelector('span').classList.toggle('text-gray-600', index !== step - 1);
                         });
                    }

                    function validateStep(step) {
                         const currentFields = steps[step - 1].querySelectorAll('input[required], select[required], textarea[required]');
                         let isValid = true;

                         currentFields.forEach(field => {
                              if (!field.checkValidity()) {
                                   field.reportValidity();
                                   isValid = false;
                              }
                         });

                         // Special validation for images on step 3
                         if (step === 3) {
                              const files = pond.getFiles();
                              if (files.length === 0) {
                                   Swal.fire({
                                        icon: 'error',
                                        title: 'Images requises',
                                        text: 'Veuillez ajouter au moins une image'
                                   });
                                   isValid = false;
                              }
                         }

                         return isValid;
                    }

                    function showLoading() {
                         submitBtn.disabled = true;
                         submitBtn.querySelector('.submit-text').classList.add('hidden');
                         submitBtn.querySelector('.loading-spinner').classList.remove('hidden');
                    }

                    function hideLoading() {
                         submitBtn.disabled = false;
                         submitBtn.querySelector('.submit-text').classList.remove('hidden');
                         submitBtn.querySelector('.loading-spinner').classList.add('hidden');
                    }

                    // Event Listeners
                    nextBtn.addEventListener('click', function () {
                         if (validateStep(currentStep)) {
                              currentStep++;
                              showStep(currentStep);
                         }
                    });

                    prevBtn.addEventListener('click', function () {
                         currentStep--;
                         showStep(currentStep);
                    });

                    serviceOptions.forEach(option => {
                         option.addEventListener('click', function () {
                              serviceOptions.forEach(el => el.classList.remove('service-option-selected'));
                              this.classList.add('service-option-selected');
                         });
                    });

                    // Form Submission
                    form.addEventListener('submit', async function (e) {
                         e.preventDefault();

                         if (!validateStep(currentStep)) {
                              return;
                         }

                         showLoading();

                         try {
                              const formData = new FormData(this);

                              // Add uploaded files' URLs to form data
                              const files = pond.getFiles();
                              const fileUrls = files.map(file => file.serverId);
                              if (fileUrls.length > 0) {
                                   formData.append('serviceImages', JSON.stringify(fileUrls));
                              }

                              // console.log(fileUrls)

                              const response = await fetch('/services/add', {
                                   method: 'POST',
                                   body: formData
                              });


                              const result = await response.json();

                              if (response.ok) {
                                   await Swal.fire({
                                        icon: 'success',
                                        title: 'Service cr√©√© avec succ√®s!',
                                        text: 'Redirection vers le tableau de bord...',
                                        showConfirmButton: false,
                                        timer: 1500
                                   });

                                   window.location.href = '/dashboard';
                              } else {
                                   throw new Error(result.message || 'Une erreur est survenue');
                              }
                         } catch (error) {
                              console.error('Error submitting form:', error);
                              Swal.fire({
                                   icon: 'error',
                                   title: 'Erreur',
                                   text: error.message || 'Une erreur est survenue lors de la cr√©ation du service'
                              });
                         } finally {
                              hideLoading();
                         }
                    });

                    // Handle step progress bar
                    function updateProgressBar() {
                         const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
                         document.getElementById('progressBar').style.width = `${progress}%`;
                    }

                    // Add progress bar update to step changes
                    const originalShowStep = showStep;
                    showStep = function (step) {
                         originalShowStep(step);
                         updateProgressBar();
                    };

                    // Initial Setup
                    showStep(currentStep);
                    updateProgressBar();
               });
          </script>
          <style>
               /* Input Focus Animation */
               .form-group:focus-within {
                    transform: translateY(-2px);
                    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
               }

               /* Hover Effects */
               .form-group:hover input,
               .form-group:hover select,
               .form-group:hover textarea {
                    background-color: white;
               }

               /* Character Count Animation */
               @keyframes pulse {

                    0%,
                    100% {
                         transform: scale(1);
                    }

                    50% {
                         transform: scale(1.05);
                    }
               }

               .char-count-warning {
                    /* animation: pulse 1s infinite; */
                    color: #fdbb40;
               }
          </style>

          <script>
               document.addEventListener('DOMContentLoaded', function () {
                    // Add character count to description
                    const textarea = document.querySelector('textarea[name="description"]');
                    const minChars = 100;

                    if (textarea) {
                         const charCountDiv = document.createElement('div');
                         charCountDiv.className = 'mt-2 text-sm transition-all duration-300';
                         textarea.parentElement.appendChild(charCountDiv);

                         textarea.addEventListener('input', function () {
                              const remaining = minChars - this.value.length;
                              if (remaining > 0) {
                                   charCountDiv.textContent = `Encore ${remaining} caract√®res recommand√©s pour une description optimale`;
                                   charCountDiv.className = 'mt-2 text-sm text-gray-500 char-count-warning';
                              } else {
                                   charCountDiv.textContent = '‚ú® Super! Votre description est bien d√©taill√©e';
                                   charCountDiv.className = 'mt-2 text-sm text-green-600';
                              }
                         });
                    }

                    // Add input animations
                    document.querySelectorAll('input, select, textarea').forEach(element => {
                         element.addEventListener('focus', () => {
                              element.closest('.form-group').classList.add('focused');
                         });

                         element.addEventListener('blur', () => {
                              element.closest('.form-group').classList.remove('focused');
                         });
                    });
               });
          </script>
</body>

</html>