<%- include('include/head.ejs', { user }) %>
     <%- include('include/navbar.ejs', { user }) %>

          <!-- Category Tabs - Horizontal Scrollable -->
          <div style="background-color: #efefef;" class="w-full overflow-x-auto scrollbar-hide sticky top-16 bg-white/95 backdrop-blur-sm z-40 border-b border-gray-200">
               <div class="container mx-auto px-4">
                    <div class="flex space-x-6 py-4 no-scrollbar">
                         <!-- All Services -->
                         <a href="/services/tous" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'tous' ? 'bg-gray-900 text-white' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">üîç</span>
                                   <span>Tous les services</span>
                              </div>
                         </a>

                         <!-- Dressage -->
                         <a href="/services/dressage" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'dressage' ? 'bg-blue-50 text-blue-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">üêï</span>
                                   <span>Dressage</span>
                              </div>
                         </a>

                         <!-- Toilettage -->
                         <a href="/services/toilettage" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'toilettage' ? 'bg-purple-50 text-purple-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">‚úÇÔ∏è</span>
                                   <span>Toilettage</span>
                              </div>
                         </a>

                         <!-- Promenade -->
                         <a href="/services/promenade" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'promenade' ? 'bg-green-50 text-green-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">ü¶Æ</span>
                                   <span>Promenade</span>
                              </div>
                         </a>

                         <!-- V√©t√©rinaire -->
                         <a href="/services/veterinaire" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'veterinaire' ? 'bg-red-50 text-red-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">‚öïÔ∏è</span>
                                   <span>V√©t√©rinaire</span>
                              </div>
                         </a>

                         <!-- Pension -->
                         <a href="/services/pension" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'pension' ? 'bg-orange-50 text-orange-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">üè†</span>
                                   <span>Pension</span>
                              </div>
                         </a>

                         <!-- Transport -->
                         <a href="/services/transport" class="flex-shrink-0 text-sm font-medium px-4 py-2.5 rounded-full transition-all duration-200 whitespace-nowrap
                         <%= serviceOption === 'transport' ? 'bg-indigo-50 text-indigo-600' : 'text-gray-500 hover:bg-gray-50' %>">
                              <div class="flex items-center space-x-2">
                                   <span class="text-base">üöó</span>
                                   <span>Transport</span>
                              </div>
                         </a>
                    </div>
               </div>

               <!-- Add subtle fade effect on scroll edges -->
               <div class="absolute left-0 top-0 bottom-0 w-8 bg-gradient-to-r from-white to-transparent pointer-events-none"></div>
               <div class="absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white to-transparent pointer-events-none"></div>
          </div>



          <!-- Add these styles to your CSS -->
          <style>
               /* Hide scrollbar but keep functionality */
               .scrollbar-hide {
                    scrollbar-width: none;
                    /* Firefox */
                    -ms-overflow-style: none;
                    /* IE and Edge */
               }

               .scrollbar-hide::-webkit-scrollbar {
                    display: none;
                    /* Chrome, Safari, Opera */
               }

               /* Smooth scroll behavior */
               .container {
                    scroll-behavior: smooth;
               }

               /* Better touch scrolling on mobile */
               .no-scrollbar {
                    -webkit-overflow-scrolling: touch;
                    scroll-snap-type: x mandatory;
                    scroll-padding: 1rem;
               }

               /* Optional: Add active tab indicator animation */
               .border-b-2 {
                    transition: border-color 0.2s ease-in-out;
               }

               /* Optional: Add hover effect for desktop */
               @media (min-width: 1024px) {
                    .hover\:text-gray-700:hover {
                         transform: translateY(-1px);
                    }
               }

               /* Optional: Add active tab scale effect */
               .border-gray-900 {
                    transform: translateY(-1px);
               }
          </style>


          <!-- Services List Container -->
          <div class="container mx-auto px-4 py-6">
               <!-- Page Header -->
               <div class="text-center mb-8">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
                         Services disponibles
                         <% if (serviceOption) { %>
                              - <%= serviceOption.charAt(0).toUpperCase() + serviceOption.slice(1) %>
                                   <% } %>
                    </h1>
                    <p class="text-gray-600 max-w-2xl mx-auto">
                         D√©couvrez les meilleurs prestataires de services animaliers pr√®s de chez vous
                    </p>
               </div>

               <!-- Location Filter Section -->
               <div class="relative mb-8">
                    <div class="flex items-center justify-between mb-4">
                         <h2 class="text-lg font-semibold text-gray-900 px-4">Choisissez votre ville</h2>
                         <!-- Mobile scroll indicators -->
                         <div class="sm:hidden flex items-center gap-1">
                              <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                              <div class="w-2 h-2 rounded-full bg-gray-200"></div>
                              <div class="w-2 h-2 rounded-full bg-gray-200"></div>
                         </div>
                    </div>

                    <!-- Mobile Slider -->
                    <div class="sm:hidden relative">
                         <div class="flex overflow-x-auto scrollbar-hide snap-x snap-mandatory gap-2 pb-4" id="locationSlider">
                              <% locations.forEach(location=> { %>
                                   <a href="/services/<%= serviceOption %>/<%= encodeURIComponent(location) %>" class="flex-none snap-start first:ml-4 last:mr-4">
                                        <div class="flex items-center px-4 py-2.5 rounded-full text-sm whitespace-nowrap
                                            bg-white text-gray-700 border border-gray-200 shadow-sm
                                            active:bg-blue-50 active:text-blue-600 active:border-blue-100
                                            <%= (currentLocation === location) ? 'bg-blue-50 text-blue-600 border-blue-200' : '' %>">
                                             <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 <%= (currentLocation === location) ? 'text-blue-500' : 'text-gray-400' %>" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                             </svg>
                                             <%= location.charAt(0).toUpperCase() + location.slice(1) %>
                                        </div>
                                   </a>
                                   <% }); %>
                         </div>
                         <!-- Fade Indicators -->
                         <div class="absolute left-0 top-0 bottom-4 w-8 bg-gradient-to-r from-white to-transparent pointer-events-none"></div>
                         <div class="absolute right-0 top-0 bottom-4 w-8 bg-gradient-to-l from-white to-transparent pointer-events-none"></div>
                    </div>

                    <!-- Desktop View -->
                    <div class="hidden sm:flex flex-wrap items-center gap-2 px-4">
                         <% locations.forEach(location=> { %>
                              <a href="/services/<%= serviceOption %>/<%= encodeURIComponent(location) %>" class="inline-flex items-center px-4 py-2.5 rounded-full text-sm font-medium
                                    bg-white text-gray-700 hover:text-blue-600 border border-gray-200
                                    hover:border-blue-100 hover:bg-blue-50 shadow-sm
                                    transition-all duration-200 
                                    <%= (currentLocation === location) ? 'bg-blue-50 text-blue-600 border-blue-200' : '' %>">
                                   <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5 <%= (currentLocation === location) ? 'text-blue-500' : 'text-gray-400' %>" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                   </svg>
                                   <%= location.charAt(0).toUpperCase() + location.slice(1) %>
                              </a>
                              <% }); %>
                    </div>
               </div>

               <!-- Services Grid -->
               <% if (services && services.length> 0) { %>
                    <!-- Service Cards Grid -->
                    <div class="grid gap-4 sm:gap-6">
                         <% services.forEach(service=> { %>
                              <a href="/service/<%= service._id %>" class="block group">
                                   <!-- Desktop Design (Hidden on Mobile) -->
                                   <div class="hidden sm:flex bg-white/60 backdrop-blur-sm border border-gray-100 rounded-2xl overflow-hidden hover:shadow-lg hover:shadow-blue-500/5 transition-all duration-300 hover:-translate-y-0.5">
                                        <!-- Image Section -->
                                        <div class="relative w-48 md:w-56 xl:w-64 flex-shrink-0">
                                             <div class="absolute inset-0 overflow-hidden">
                                                  <% if (service.images && service.images.length> 0) { %>
                                                       <img src="<%= service.images[0] %>" alt="<%= service.serviceOptions?.[0] %>" class="h-full w-full object-cover transform transition duration-700 group-hover:scale-110" loading="lazy">
                                                       <% } else { %>
                                                            <div class="h-full bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center">
                                                                 <div class="rounded-full bg-white/80 p-3">
                                                                      <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                           <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                                      </svg>
                                                                 </div>
                                                            </div>
                                                            <% } %>
                                                                 <!-- Gradient Overlay -->
                                                                 <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                                             </div>

                                             <!-- Service Badge -->
                                             <% const serviceIcons={ 'dressage' : { emoji: 'üêï' , color: 'blue' }, 'toilettage' : { emoji: '‚úÇÔ∏è' , color: 'purple' }, 'promenade' : { emoji: 'ü¶Æ' , color: 'green' }, 'veterinaire' : { emoji: '‚öïÔ∏è' , color: 'red' }, 'pension' : { emoji: 'üè†' , color: 'orange' }, 'transport' : { emoji: 'üöó' , color: 'indigo' } }; %>
                                                  <% const serviceType=service.serviceOptions.toLowerCase(); %>
                                                       <% const iconData=serviceIcons[serviceType] || { emoji: 'üêæ' , color: 'gray' }; %>

                                                            <div class="absolute top-3 left-3 z-10">
                                                                 <div class="flex items-center gap-2 bg-white/95 backdrop-blur px-3 py-1.5 rounded-full shadow-sm border border-white/20">
                                                                      <span class="text-base">
                                                                           <%= iconData.emoji %>
                                                                      </span>
                                                                      <span class="text-xs font-medium text-gray-700">
                                                                           <%= service.serviceOptions %>
                                                                      </span>
                                                                 </div>
                                                            </div>
                                        </div>

                                        <!-- Content Section -->
                                        <div class="flex-1 p-5 flex flex-col">
                                             <div class="flex items-start justify-between gap-4 mb-3">
                                                  <!-- Title and Rating -->
                                                  <div>
                                                       <h3 class="text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors">
                                                            <%= service.serviceName || service.serviceOptions %>
                                                       </h3>

                                                       <!-- Rating Pills -->
                                                       <div class="flex items-center gap-3 mt-2">
                                                            <div class="flex items-center">
                                                                 <div class="flex items-center bg-amber-50 px-2.5 py-1 rounded-full border border-amber-100">
                                                                      <span class="text-sm font-medium text-amber-700 mr-1">
                                                                           <%= service.rating || 4.9 %>
                                                                      </span>
                                                                      <svg class="w-4 h-4 text-amber-400" viewBox="0 0 20 20" fill="currentColor">
                                                                           <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                                      </svg>
                                                                 </div>
                                                                 <span class="text-sm text-gray-500 ml-2">
                                                                      (<%= service.reviewsCount || '12' %> avis)
                                                                 </span>
                                                            </div>
                                                       </div>
                                                  </div>

                                                  <!-- Price Tag -->
                                                  <div class="flex flex-col items-end">
                                                       <div class="text-lg font-bold text-gray-900">
                                                            <%= service.priceRange ? `${service.priceRange}` : 'Sur devis' %>
                                                       </div>
                                                       <div class="text-xs text-gray-500">par s√©ance</div>
                                                  </div>
                                             </div>

                                             <!-- Info Pills -->
                                             <div class="flex flex-wrap gap-2 mb-4">
                                                  <div class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-gray-50 text-gray-700 text-sm">
                                                       <svg class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                                       </svg>
                                                       <%= service.location || 'Non sp√©cifi√©' %>
                                                  </div>
                                                  <div class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-gray-50 text-gray-700 text-sm">
                                                       <svg class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                       </svg>
                                                       <%= service.availability || 'Sur rendez-vous' %>
                                                  </div>
                                             </div>

                                             <!-- Provider Section -->
                                             <div class="mt-auto pt-4 flex items-center justify-between border-t border-gray-100">
                                                  <div class="flex items-center gap-3">
                                                       <div class="relative">
                                                            <img src="<%= service.createdBy?.profileImage || '/default-avatar.png' %>" class="w-10 h-10 rounded-full object-cover ring-2 ring-white" alt="<%= service.createdBy?.displayName %>">
                                                            <% if (service.createdBy?.isVerified) { %>
                                                                 <div class="absolute -bottom-1 -right-1 bg-white rounded-full p-0.5">
                                                                      <svg class="w-4 h-4 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                                                                           <path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" />
                                                                      </svg>
                                                                 </div>
                                                                 <% } %>
                                                       </div>
                                                       <div>
                                                            <div class="text-sm font-medium text-gray-900">
                                                                 <%= service.createdBy?.displayName || 'Service Provider' %>
                                                            </div>
                                                            <div class="text-xs text-gray-500">Prestataire professionnel</div>
                                                       </div>
                                                  </div>

                                                  <div class="flex items-center gap-2 text-blue-600 font-medium">
                                                       <span class="text-sm">Voir d√©tails</span>
                                                       <svg class="w-5 h-5 transform transition-transform group-hover:translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                                       </svg>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>

                                   <!-- Mobile Design -->
                                   <div class="sm:hidden bg-white/60 backdrop-blur-sm border border-gray-100 rounded-xl overflow-hidden active:scale-[0.99] transition-all">
                                        <div class="relative aspect-video">
                                             <% if (service.images && service.images.length> 0) { %>
                                                  <img src="<%= service.images[0] %>" alt="<%= service.serviceOptions?.[0] %>" class="w-full h-full object-cover" loading="lazy">
                                                  <% } else { %>
                                                       <div class="w-full h-full bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center">
                                                            <div class="rounded-full bg-white/80 p-3">
                                                                 <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                      <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                                                 </svg>
                                                            </div>
                                                       </div>
                                                       <% } %>

                                                            <!-- Service Badge -->
                                                            <div class="absolute top-3 left-3">
                                                                 <div class="flex items-center gap-2 bg-white/95 backdrop-blur px-2.5 py-1 rounded-full shadow-sm">
                                                                      <span>
                                                                           <%= iconData.emoji %>
                                                                      </span>
                                                                      <span class="text-xs font-medium text-gray-700">
                                                                           <%= service.serviceOptions %>
                                                                      </span>
                                                                 </div>
                                                            </div>

                                                            <!-- Price Badge -->
                                                            <div class="absolute top-3 right-3">
                                                                 <div class="bg-white/95 backdrop-blur px-2.5 py-1 rounded-full shadow-sm text-sm font-semibold text-gray-900">
                                                                      <%= service.priceRange ? `${service.priceRange}` : 'Sur devis' %>
                                                                 </div>
                                                            </div>
                                        </div>

                                        <div class="p-4">
                                             <div class="flex items-start justify-between gap-3 mb-3">
                                                  <h3 class="text-base font-semibold text-gray-900">
                                                       <%= service.serviceName || service.serviceOptions %>
                                                  </h3>
                                                  <div class="flex items-center bg-amber-50 px-2 py-1 rounded-full">
                                                       <span class="text-sm font-medium text-amber-700 mr-1">
                                                            <%= service.rating || 4.9 %>
                                                       </span>
                                                       <svg class="w-3.5 h-3.5 text-amber-400" viewBox="0 0 20 20" fill="currentColor">
                                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                       </svg>
                                                  </div>
                                             </div>

                                             <div class="flex items-center gap-2 text-xs">
                                                  <div class="flex items-center gap-1 text-gray-600">
                                                       <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                                       </svg>
                                                       <%= service.location || 'Non sp√©cifi√©' %>
                                                  </div>
                                                  <span class="text-gray-300">‚Ä¢</span>
                                                  <span class="text-gray-600">
                                                       <%= service.reviewsCount || '12' %> avis
                                                  </span>
                                             </div>

                                             <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-100">
                                                  <div class="flex items-center gap-2">
                                                       <div class="relative flex-shrink-0">
                                                            <img src="<%= service.createdBy?.profileImage || '/default-avatar.png' %>" class="w-8 h-8 rounded-full object-cover ring-2 ring-white" alt="<%= service.createdBy?.displayName %>">
                                                            <% if (service.createdBy?.isVerified) { %>
                                                                 <div class="absolute -bottom-0.5 -right-0.5 bg-white rounded-full p-0.5">
                                                                      <svg class="w-3 h-3 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                                                                           <path d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" />
                                                                      </svg>
                                                                 </div>
                                                                 <% } %>
                                                       </div>
                                                       <div class="min-w-0">
                                                            <div class="text-sm font-medium text-gray-900 truncate">
                                                                 <%= service.createdBy?.displayName || 'Service Provider' %>
                                                            </div>
                                                            <div class="text-xs text-gray-500">Pro</div>
                                                       </div>
                                                  </div>

                                                  <!-- Mobile Action Button -->
                                                  <div class="flex items-center text-blue-600">
                                                       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                                       </svg>
                                                  </div>
                                             </div>
                                        </div>
                                   </div>
                              </a>
                              <% }); %>
                    </div>

                    <!-- Optional Loading Skeleton -->
                    <div class="animate-pulse grid gap-4 sm:gap-6" id="loadingSkeleton" style="display: none;">
                         <!-- Desktop Skeleton -->
                         <div class="hidden sm:flex bg-white border border-gray-100 rounded-2xl overflow-hidden h-48">
                              <div class="w-48 bg-gray-200"></div>
                              <div class="flex-1 p-5">
                                   <div class="h-4 bg-gray-200 rounded w-3/4 mb-4"></div>
                                   <div class="h-3 bg-gray-200 rounded w-1/4 mb-4"></div>
                                   <div class="flex gap-2 mb-4">
                                        <div class="h-6 w-24 bg-gray-200 rounded-full"></div>
                                        <div class="h-6 w-24 bg-gray-200 rounded-full"></div>
                                   </div>
                                   <div class="mt-auto pt-4 border-t border-gray-100">
                                        <div class="flex items-center gap-3">
                                             <div class="w-10 h-10 rounded-full bg-gray-200"></div>
                                             <div class="flex-1">
                                                  <div class="h-3 bg-gray-200 rounded w-1/2"></div>
                                             </div>
                                        </div>
                                   </div>
                              </div>
                         </div>

                         <!-- Mobile Skeleton -->
                         <div class="sm:hidden bg-white rounded-xl overflow-hidden">
                              <div class="aspect-video bg-gray-200"></div>
                              <div class="p-4">
                                   <div class="h-4 bg-gray-200 rounded w-3/4 mb-4"></div>
                                   <div class="h-3 bg-gray-200 rounded w-1/2 mb-4"></div>
                                   <div class="flex items-center justify-between mt-4 pt-4 border-t border-gray-100">
                                        <div class="flex items-center gap-2">
                                             <div class="w-8 h-8 rounded-full bg-gray-200"></div>
                                             <div class="h-3 bg-gray-200 rounded w-20"></div>
                                        </div>
                                   </div>
                              </div>
                         </div>
                    </div>
                    <% }else { %>
                         <!-- Empty State -->
                         <div class="text-center py-16 bg-white rounded-2xl border border-gray-200">
                              <div class="max-w-md mx-auto">
                                   <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-50 mb-4">
                                        <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                   </div>
                                   <h3 class="text-lg font-semibold text-gray-900 mb-2">
                                        Aucun service disponible
                                   </h3>
                                   <p class="text-gray-500 mb-6">
                                        Aucun service n'est actuellement disponible dans cette cat√©gorie.
                                   </p>
                                   <a href="/services" class="inline-flex items-center justify-center px-4 py-2 border border-transparent 
                                                             text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 
                                                             transition-colors">
                                        Voir tous les services
                                   </a>
                              </div>
                         </div>
                         <% } %>

                              <style>
                                   /* Custom Scrollbar */
                                   .custom-scrollbar {
                                        scrollbar-width: thin;
                                        scrollbar-color: #E5E7EB transparent;
                                   }

                                   .custom-scrollbar::-webkit-scrollbar {
                                        width: 6px;
                                        height: 6px;
                                   }

                                   .custom-scrollbar::-webkit-scrollbar-track {
                                        background: transparent;
                                   }

                                   .custom-scrollbar::-webkit-scrollbar-thumb {
                                        background-color: #E5E7EB;
                                        border-radius: 3px;
                                   }

                                   /* Smooth Transitions */
                                   .transition-all {
                                        transition-property: all;
                                        transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                                        transition-duration: 300ms;
                                   }

                                   /* Card Hover Animation */
                                   @keyframes softPulse {
                                        0% {
                                             transform: scale(1);
                                        }

                                        50% {
                                             transform: scale(1.02);
                                        }

                                        100% {
                                             transform: scale(1);
                                        }
                                   }

                                   .hover-pulse:hover {
                                        animation: softPulse 2s infinite;
                                   }

                                   /* Image Loading Animation */
                                   .image-loading {
                                        background: linear-gradient(90deg, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
                                        background-size: 200% 100%;
                                        animation: shimmer 1.5s infinite;
                                   }

                                   @keyframes shimmer {
                                        0% {
                                             background-position: -200% 0;
                                        }

                                        100% {
                                             background-position: 200% 0;
                                        }
                                   }
                              </style>

                              <script>
                                   // Lazy Loading Images
                                   document.addEventListener('DOMContentLoaded', () => {
                                        const images = document.querySelectorAll('img[loading="lazy"]');
                                        const imageOptions = {
                                             threshold: 0.1,
                                             rootMargin: '50px'
                                        };

                                        const imageObserver = new IntersectionObserver((entries, observer) => {
                                             entries.forEach(entry => {
                                                  if (entry.isIntersecting) {
                                                       const img = entry.target;
                                                       img.classList.add('animate-fade-in');
                                                       observer.unobserve(img);
                                                  }
                                             });
                                        }, imageOptions);

                                        images.forEach(img => imageObserver.observe(img));
                                   });

                                   // Touch Feedback
                                   const cards = document.querySelectorAll('.sm\\:hidden');
                                   cards.forEach(card => {
                                        card.addEventListener('touchstart', () => {
                                             card.style.transform = 'scale(0.98)';
                                        });

                                        card.addEventListener('touchend', () => {
                                             card.style.transform = 'scale(1)';
                                        });
                                   });

                                   // Optional: Load More Functionality
                                   function showLoadingSkeleton() {
                                        document.getElementById('loadingSkeleton').style.display = 'grid';
                                   }

                                   function hideLoadingSkeleton() {
                                        document.getElementById('loadingSkeleton').style.display = 'none';
                                   }
                              </script>


          </div>


          <%- include('./include/footer') %>

               <!-- Styles -->
               <style>
                    /* Hide scrollbar but keep functionality */
                    .scrollbar-hide {
                         -ms-overflow-style: none;
                         scrollbar-width: none;
                    }

                    .scrollbar-hide::-webkit-scrollbar {
                         display: none;
                    }

                    /* Smooth scroll behavior */
                    #locationSlider {
                         -webkit-overflow-scrolling: touch;
                         scroll-behavior: smooth;
                    }

                    /* Animation for card hover */
                    .group:hover .group-hover\:scale-105 {
                         transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                         transition-duration: 500ms;
                    }
               </style>

               <!-- JavaScript -->
               <script>
                    document.addEventListener('DOMContentLoaded', function () {
                         const slider = document.getElementById('locationSlider');
                         let isScrolling = false;

                         // Handle scroll snap
                         slider.addEventListener('scroll', () => {
                              window.clearTimeout(isScrolling);
                              isScrolling = setTimeout(() => {
                                   const scrollLeft = slider.scrollLeft;
                                   const itemWidth = slider.querySelector('a').offsetWidth;
                                   const newScrollLeft = Math.round(scrollLeft / itemWidth) * itemWidth;

                                   slider.scrollTo({
                                        left: newScrollLeft,
                                        behavior: 'smooth'
                                   });
                              }, 150);
                         });

                         // Update dots indicator based on scroll position
                         function updateDots() {
                              const dots = document.querySelectorAll('.dot');
                              const scrollPercentage = slider.scrollLeft / (slider.scrollWidth - slider.clientWidth);
                              const activeDotIndex = Math.round(scrollPercentage * (dots.length - 1));

                              dots.forEach((dot, index) => {
                                   if (index === activeDotIndex) {
                                        dot.classList.add('bg-blue-500');
                                        dot.classList.remove('bg-gray-200');
                                   } else {
                                        dot.classList.remove('bg-blue-500');
                                        dot.classList.add('bg-gray-200');
                                   }
                              });
                         }

                         slider.addEventListener('scroll', updateDots);
                    });
               </script>
               <style>
                    /* Smooth transitions */
                    .group {
                         cursor: pointer;
                         transform: translateZ(0);
                    }

                    /* Line clamp fallback */
                    .line-clamp-1 {
                         display: -webkit-box;
                         -webkit-line-clamp: 1;
                         -webkit-box-orient: vertical;
                         overflow: hidden;
                    }

                    /* Touch-friendly sizing for mobile */
                    @media (max-width: 640px) {
                         .group {
                              min-height: 120px;
                         }

                         .group:active {
                              transform: scale(0.98);
                         }
                    }

                    /* Image aspect ratio fix */
                    .aspect-square {
                         aspect-ratio: 1;
                    }
               </style>